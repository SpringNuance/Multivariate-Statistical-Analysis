---
title: "Multivariate Statistical Analysis Project Report"
author: "Nguyen Xuan Binh - 887799"
fontsize: 10pt
header-includes:
   - \usepackage{amssymb}
output:
  pdf_document:
    toc: no
    toc_depth: 1
  word_document:
    toc: no
    toc_depth: '1'
urlcolor: blue
---


# 1. INTRODUCTION (0.5 point)

```{r echo=FALSE}

```

description of the research question and of the data source or data collection

Is it possible to find clusters of European countries based on energy data? How are the clusters located geographically?

Does PCA reveal something interesting about Finnish municipalities if PCA is applied to data that contains several variables related to economy of the municipalities? Can we conduct dimension reduction successfully and can we use principal components to detect "crises municipalities"?

Are the misclassification rates acceptable if Fisher linear discriminant analysis is applied in classifying my exercise data into business days and weekends? Does it tell something about my exercise routines?

In your settings, you could, e.g., try to cluster composite materials based on the variables you mentioned. Or you could use PCA to see if dimension reduction is possible without loosing too much information. 

It is enough to have 1 research question.

You can have labeled or unlabeled data. 

New material discoveries are a major driver of technological development. The discovery of steel and bronze in antiquity and the development of synthetic polymers in the 20th century were two examples of how new materials have drastically altered human society. These days, advances in materials science are also essential for addressing some of the most important social issues, like climate change and the future of our energy supply.

Nonetheless, there is still a lot of trial and error involved in materials discovery today. Finding a material that is appropriate for a technological use might take decades of study, and optimizing that material for commercialization can take much longer. 

In this report, I introduce the Materials Project (www.materialsproject.org) dataset [1], which is a component of the Materials Genome Initiative. One of the Materials Projectâ€™s key purpose is to compute the properties of compounds for which experimental data may be incomplete. This comprehensive dataset consists of 83989 atoms/molecules, which is the version on 2018. The dataset is available at this URL

https://figshare.com/articles/dataset/Materials_Project_Data/7227749




There are also other 3 columns, elastic_anisotropy, K_VRH (Voigt-Reuss-Hill average of the bulk modulus), G_VRH (Voigt-Reuss-Hill average of the shear modulus) that are not included for analysis in this report. The main reason is that they have too many empty values and imputing them is practically impossible. In reality, these three properties require huge computing powers to obtain, so naturally those three properties are still unknown for many molecules.  


"Can clustering analysis on the Materials Project dataset identify distinct groups of materials based on their energy-related properties, and are these groups indicative of potential candidates for renewable energy applications?"

Rationale for the Question:
This research question is designed to explore the potential of materials for applications in renewable energy, a pressing global issue. The properties provided in the dataset offer a unique opportunity to assess materials from various perspectives:


# 2. Univariate analysis (1 point)

## 2.1 Description of the variables

In this dataset, there are in total 7 columns, 6 of which are properties of the atoms or molecules. The first column contains the chemical formula for the corresponding atom or molecule based on IUPAC nomenclature. 



The six columns (properties) are:

\begin{itemize}

\item energy_above_hull: This represents the energy above the convex hull for a given material. If a material has an energy above hull of zero, it is on the convex hull and is considered thermodynamically stable. A positive value indicates how much energy would need to be removed from the material to make it as stable as the stable phases on the hull. This is crucial for understanding phase stability in materials science.

\item band_gap: This is an energy range in a solid where no electronic states exist. Substances having large band gaps (also called "wide" band gaps) are generally insulators, those with small band gaps (also called "narrow" band gaps) are semiconductor, and conductors either have very small band gaps or none, because the valence and conduction bands overlap to form a continuous band.

\item total_magnetization: This is the density of permanent or induced magnetic dipole moments within a magnetic material.

\item total_energy: This includes both kinetic energy (associated with molecular motion) and potential energy (related to chemical bonds) for an atom or the whole molecule

\item energy_per_atom: This is the total energy divided by the number of atoms in the unit cell. It provides a way to compare the energy contents of materials with different sizes and compositions.

\item formation_energy_per_atom: This is the amount of energy evolved or absorbed when a substance is formed from its constituent elements in a certain condition of temperature and pressure

\end{itemize}



Energy_above_hull: Indicates stability, which is critical for practical applications.
Band_gap: Directly relates to electronic and optical properties crucial for photovoltaic materials and semiconductors.
Total_magnetization: Important for materials used in energy storage and magnetic applications.
Total_energy and energy_per_atom: Give insights into the energetic favorability and efficiency of materials.
Formation_energy_per_atom: Reflects the viability of synthesizing materials under typical conditions.






## 2.2 summary statistics and visualization

For univariate analysis summary statistics (e.g. means, medians, variances, median absolute deviations, skewness and kurtosis values) and possible visualizations are enough (no need to conduct statistical testing or give confidence intervals here).

### Load the Dataset

```{r }
# Load necessary libraries
library(dplyr)
library(ggplot2)
library(moments)

# Load the dataset
data <- read.csv("mp_nostruct_clean.csv")
```

```{r echo=FALSE}
### Calculate and Display Summary Statistics for All Properties

summary_stats <- data %>%
  summarise(
    Mean_EnergyAboveHull = mean(energy_above_hull, na.rm = TRUE),
    Median_EnergyAboveHull = median(energy_above_hull, na.rm = TRUE),
    Variance_EnergyAboveHull = var(energy_above_hull, na.rm = TRUE),
    MAD_EnergyAboveHull = mad(energy_above_hull, na.rm = TRUE),
    Skewness_EnergyAboveHull = skewness(energy_above_hull, na.rm = TRUE),
    Kurtosis_EnergyAboveHull = kurtosis(energy_above_hull, na.rm = TRUE),

    Mean_BandGap = mean(band_gap, na.rm = TRUE),
    Median_BandGap = median(band_gap, na.rm = TRUE),
    Variance_BandGap = var(band_gap, na.rm = TRUE),
    MAD_BandGap = mad(band_gap, na.rm = TRUE),
    Skewness_BandGap = skewness(band_gap, na.rm = TRUE),
    Kurtosis_BandGap = kurtosis(band_gap, na.rm = TRUE),

    Mean_TotalMagnetization = mean(total_magnetization, na.rm = TRUE),
    Median_TotalMagnetization = median(total_magnetization, na.rm = TRUE),
    Variance_TotalMagnetization = var(total_magnetization, na.rm = TRUE),
    MAD_TotalMagnetization = mad(total_magnetization, na.rm = TRUE),
    Skewness_TotalMagnetization = skewness(total_magnetization, na.rm = TRUE),
    Kurtosis_TotalMagnetization = kurtosis(total_magnetization, na.rm = TRUE),

    Mean_TotalEnergy = mean(total_energy, na.rm = TRUE),
    Median_TotalEnergy = median(total_energy, na.rm = TRUE),
    Variance_TotalEnergy = var(total_energy, na.rm = TRUE),
    MAD_TotalEnergy = mad(total_energy, na.rm = TRUE),
    Skewness_TotalEnergy = skewness(total_energy, na.rm = TRUE),
    Kurtosis_TotalEnergy = kurtosis(total_energy, na.rm = TRUE),

    Mean_EnergyPerAtom = mean(energy_per_atom, na.rm = TRUE),
    Median_EnergyPerAtom = median(energy_per_atom, na.rm = TRUE),
    Variance_EnergyPerAtom = var(energy_per_atom, na.rm = TRUE),
    MAD_EnergyPerAtom = mad(energy_per_atom, na.rm = TRUE),
    Skewness_EnergyPerAtom = skewness(energy_per_atom, na.rm = TRUE),
    Kurtosis_EnergyPerAtom = kurtosis(energy_per_atom, na.rm = TRUE),

    Mean_FormationEnergyPerAtom = mean(formation_energy_per_atom, na.rm = TRUE),
    Median_FormationEnergyPerAtom = median(formation_energy_per_atom, na.rm = TRUE),
    Variance_FormationEnergyPerAtom = var(formation_energy_per_atom, na.rm = TRUE),
    MAD_FormationEnergyPerAtom = mad(formation_energy_per_atom, na.rm = TRUE),
    Skewness_FormationEnergyPerAtom = skewness(formation_energy_per_atom, na.rm = TRUE),
    Kurtosis_FormationEnergyPerAtom = kurtosis(formation_energy_per_atom, na.rm = TRUE)
  ) 

# Transpose the summary_stats dataframe
summary_stats <- t(summary_stats)

# Create a dataframe with the first 6 rows and first 6 columns of the transposed dataframe
summary_stats <- as.data.frame(summary_stats)

print()
# Print the summary statistics table
# knitr::kable(summary_stats, format = "html", caption = "Summary Statistics for Material Properties")

```

```{r echo=FALSE}
rm(list = ls())

```

```{r echo=FALSE}
library(reshape2)

# Convert rownames to a new column
summary_stats <- cbind(variable = rownames(summary_stats), summary_stats)

# Melt the dataframe
summary_stats_melted <- melt(summary_stats, id.vars = "variable")

# Cast the melted dataframe to the desired format
summary_stats_reshaped <- dcast(summary_stats_melted, variable ~ variable, value.var = "value")

# Remove the 'variable' column which was used for reshaping
summary_stats_reshaped <- summary_stats_reshaped[, -1]

# Print the reshaped dataframe
print(summary_stats_reshaped)

```


# 3. Bivariate analysis (1 point)

analysis of bivariate dependencies, visualization

For the bivariate analysis visualizations (e.g., scatter plots) or pairwise Pearson or Spearman correlations, or attraction-repulsion indices are enough. There is no need for testing or confidence intervals here either.

For bivariate analysis visualizations (e.g. scatter plots) or pairwise Pearson or Spearman correlations, or attraction-repulsion indices are enough (no need for testing or confidence intervals here either).

```{r echo=FALSE}

```

```{r echo=FALSE}

```

```{r echo=FALSE}

```

```{r echo=FALSE}

```

# 4. Multivariate analysis (3 point)

One should have at least 3-variate data, and one should use one of the methods from the course (traditional or robust PCA, MCA, CCA, classification (Fisher's linear discriminant analysis or depth based) or clustering (k-centers or hierarchical)). The choice of method should be justified, and results should be interpreted and discussed. If one used a method that was not discussed during the course, one should add an appendix describing the method (mathematically and intuitively).


For multivariate part, one should have at least 3-variate data, and one should use PCA (traditional or robust), MCA, CCA, classification (FLDA or depth based) or clustering (k-centers or hierarchical). Choice of method should be justified, and results should be interpreted and discussed.  If one used a method that is not discussed during the course, one should add an appendix describing the method (mathematically and intuitively). 

```{r echo=FALSE}

```

```{r echo=FALSE}

```

```{r echo=FALSE}

```

```{r echo=FALSE}

```

## a. Selection of methods (1 point)

## b. Technical implementation (1 point)

## c. Result presentation and interpretation (1 point)

# 5. Critical evaluations (0.5 point) 

report about possible sources of biases etc.

# References

[1] Jain, A.; Ong, S.; Hautier, G.; Chen, W.; Richards, W.; Dacek, S., et al. (2013). Commentary: The Materials Project: A materials genome approach to accelerating materials innovation. APL Materials, 1(1), 011002. Report #: ARTN 011002. http://dx.doi.org/10.1063/1.4812323 Retrieved from https://escholarship.org/uc/item/3h26p692
